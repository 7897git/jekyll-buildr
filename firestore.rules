
rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {
    
    // Secara default, tolak semua akses baca dan tulis.
    match /{document=**} {
      allow read, write: if false;
    }

    // Izinkan pengguna yang sudah login (terautentikasi) untuk membuat dokumen mereka sendiri.
    // Izinkan pengguna yang sudah login untuk membaca dokumen mereka sendiri.
    match /users/{userId} {
      allow create, read: if request.auth != null && request.auth.uid == userId;
    }

    // Izinkan pengguna yang sudah login untuk membaca dan menulis di dalam sub-koleksi mereka sendiri.
    // Ini penting untuk menyimpan pengaturan, konten, dll.
    match /users/{userId}/{documents=**} {
      allow read, write: if request.auth != null && request.auth.uid == userId;
    }
  }
}
